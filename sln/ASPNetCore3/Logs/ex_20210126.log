2021-01-26T16:23:01.6042627+07:00 [ERR] (ASPNetCore3.ServiceImpl.StockCrawlerService) CrawlerTransactionHistory - fail on crawler report accounting balance NVT ======= 
2021-01-26T16:23:01.6105130+07:00 [ERR] (ASPNetCore3.ServiceImpl.StockCrawlerService) The multi-part identifier "c.Quarter" could not be bound.
The multi-part identifier "c.Year" could not be bound.
2021-01-26T16:23:01.7184454+07:00 [ERR] (ASPNetCore3.ServiceImpl.StockCrawlerService)    at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__164_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Dapper.SqlMapper.QueryRowAsync[T](IDbConnection cnn, Row row, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 473
   at Infrastructure.Repository.StockReportAccountingBalanceRepository.GetByCodeOnTime(String code, String quarter, String year) in D:\Source\B\src\Infrastructure\Repository\StockReportAccountingBalanceRepository.cs:line 34
   at Infrastructure.Repository.StockReportAccountingBalanceRepository.GetByCodeOnTime(String code, String quarter, String year) in D:\Source\B\src\Infrastructure\Repository\StockReportAccountingBalanceRepository.cs:line 39
   at ASPNetCore3.ServiceImpl.StockCrawlerService.CrawlerReportAccountingBalance(String code, ChromeDriver driver) in D:\Source\B\sln\ASPNetCore3\ServiceImpl\StockCrawlerService.cs:line 422
2021-01-26T16:43:49.4100704+07:00 [ERR] (Microsoft.EntityFrameworkCore.Database.Command) Failed executing DbCommand ("63"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int64), @p5='?' (DbType = Single), @p6='?' (Size = 4000), @p7='?' (DbType = DateTime2), @p8='?' (Size = 4000), @p9='?' (DbType = DateTime2), @p10='?' (DbType = Int64), @p11='?' (DbType = Single), @p12='?' (Size = 4000), @p13='?' (DbType = DateTime2), @p14='?' (Size = 4000), @p15='?' (DbType = DateTime2), @p16='?' (DbType = Int64), @p17='?' (DbType = Single), @p18='?' (Size = 4000), @p19='?' (DbType = DateTime2), @p20='?' (Size = 4000), @p21='?' (DbType = DateTime2), @p22='?' (DbType = Int64), @p23='?' (DbType = Single), @p24='?' (Size = 4000), @p25='?' (DbType = DateTime2), @p26='?' (Size = 4000), @p27='?' (DbType = DateTime2), @p28='?' (DbType = Int64), @p29='?' (DbType = Single), @p39='?' (DbType = Int64), @p30='?' (Size = 4000), @p31='?' (Size = 4000), @p32='?' (DbType = DateTime2), @p33='?' (Size = 4000), @p34='?' (DbType = DateTime2), @p35='?' (Size = 4000), @p36='?' (DbType = Single), @p37='?' (DbType = Single), @p38='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [RPAB_LoiIchCuaCoDongKhongKiemSoatTruoc2015] ([CreatedBy], [CreatedOn], [LastModifiedBy], [LastModifiedOn], [StockReportAccountingBalanceId], [TongCong])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [Id]
FROM [RPAB_LoiIchCuaCoDongKhongKiemSoatTruoc2015]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();

INSERT INTO [RPAB_NoPhaiTra] ([CreatedBy], [CreatedOn], [LastModifiedBy], [LastModifiedOn], [StockReportAccountingBalanceId], [TongCong])
VALUES (@p6, @p7, @p8, @p9, @p10, @p11);
SELECT [Id]
FROM [RPAB_NoPhaiTra]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();

INSERT INTO [RPAB_TaiSanDaiHan] ([CreatedBy], [CreatedOn], [LastModifiedBy], [LastModifiedOn], [StockReportAccountingBalanceId], [TongCong])
VALUES (@p12, @p13, @p14, @p15, @p16, @p17);
SELECT [Id]
FROM [RPAB_TaiSanDaiHan]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();

INSERT INTO [RPAB_TaiSanNganHan] ([CreatedBy], [CreatedOn], [LastModifiedBy], [LastModifiedOn], [StockReportAccountingBalanceId], [TongCong])
VALUES (@p18, @p19, @p20, @p21, @p22, @p23);
SELECT [Id]
FROM [RPAB_TaiSanNganHan]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();

INSERT INTO [RPAB_VonChuSoHuu] ([CreatedBy], [CreatedOn], [LastModifiedBy], [LastModifiedOn], [StockReportAccountingBalanceId], [TongCong])
VALUES (@p24, @p25, @p26, @p27, @p28, @p29);
SELECT [Id]
FROM [RPAB_VonChuSoHuu]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();

UPDATE [StockReportAccountingBalance] SET [Code] = @p30, [CreatedBy] = @p31, [CreatedOn] = @p32, [LastModifiedBy] = @p33, [LastModifiedOn] = @p34, [Quarter] = @p35, [TongCongNguonVon] = @p36, [TongCongTaiSan] = @p37, [Year] = @p38
WHERE [Id] = @p39;
SELECT @@ROWCOUNT;"
2021-01-26T16:43:49.4905013+07:00 [ERR] (Microsoft.EntityFrameworkCore.Update) An exception occurred in the database while saving changes for context type '"Infrastructure.Data.ApplicationDbContext"'."
""Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert duplicate key row in object 'dbo.RPAB_LoiIchCuaCoDongKhongKiemSoatTruoc2015' with unique index 'IX_RPAB_LoiIchCuaCoDongKhongKiemSoatTruoc2015_StockReportAccountingBalanceId'. The duplicate key value is (1).
Cannot insert duplicate key row in object 'dbo.RPAB_NoPhaiTra' with unique index 'IX_RPAB_NoPhaiTra_StockReportAccountingBalanceId'. The duplicate key value is (1).
Cannot insert duplicate key row in object 'dbo.RPAB_TaiSanDaiHan' with unique index 'IX_RPAB_TaiSanDaiHan_StockReportAccountingBalanceId'. The duplicate key value is (1).
Cannot insert duplicate key row in object 'dbo.RPAB_TaiSanNganHan' with unique index 'IX_RPAB_TaiSanNganHan_StockReportAccountingBalanceId'. The duplicate key value is (1).
Cannot insert duplicate key row in object 'dbo.RPAB_VonChuSoHuu' with unique index 'IX_RPAB_VonChuSoHuu_StockReportAccountingBalanceId'. The duplicate key value is (1).
The statement has been terminated.
The statement has been terminated.
The statement has been terminated.
The statement has been terminated.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__164_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:da8a2a12-285d-4ff3-91f5-0c779a243e3a
Error Number:2601,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)"
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert duplicate key row in object 'dbo.RPAB_LoiIchCuaCoDongKhongKiemSoatTruoc2015' with unique index 'IX_RPAB_LoiIchCuaCoDongKhongKiemSoatTruoc2015_StockReportAccountingBalanceId'. The duplicate key value is (1).
Cannot insert duplicate key row in object 'dbo.RPAB_NoPhaiTra' with unique index 'IX_RPAB_NoPhaiTra_StockReportAccountingBalanceId'. The duplicate key value is (1).
Cannot insert duplicate key row in object 'dbo.RPAB_TaiSanDaiHan' with unique index 'IX_RPAB_TaiSanDaiHan_StockReportAccountingBalanceId'. The duplicate key value is (1).
Cannot insert duplicate key row in object 'dbo.RPAB_TaiSanNganHan' with unique index 'IX_RPAB_TaiSanNganHan_StockReportAccountingBalanceId'. The duplicate key value is (1).
Cannot insert duplicate key row in object 'dbo.RPAB_VonChuSoHuu' with unique index 'IX_RPAB_VonChuSoHuu_StockReportAccountingBalanceId'. The duplicate key value is (1).
The statement has been terminated.
The statement has been terminated.
The statement has been terminated.
The statement has been terminated.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__164_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:da8a2a12-285d-4ff3-91f5-0c779a243e3a
Error Number:2601,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-01-26T16:43:49.6225998+07:00 [ERR] (ASPNetCore3.ServiceImpl.StockCrawlerService) CrawlerTransactionHistory - fail on crawler report accounting balance NVT ======= 
2021-01-26T16:43:49.6226865+07:00 [ERR] (ASPNetCore3.ServiceImpl.StockCrawlerService) An error occurred while updating the entries. See the inner exception for details.
2021-01-26T16:43:49.6517911+07:00 [ERR] (ASPNetCore3.ServiceImpl.StockCrawlerService)    at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Infrastructure.Repository.RepositoryWrapper.SaveChangeAsync() in D:\Source\B\src\Infrastructure\Repository\RepositoryWrapper.cs:line 105
   at ASPNetCore3.ServiceImpl.StockCrawlerService.CrawlerReportAccountingBalance(String code, ChromeDriver driver) in D:\Source\B\sln\ASPNetCore3\ServiceImpl\StockCrawlerService.cs:line 430
2021-01-26T16:43:57.3321431+07:00 [ERR] (Microsoft.EntityFrameworkCore.Database.Command) Failed executing DbCommand ("49"ms) [Parameters=["@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int64), @p5='?' (DbType = Single), @p6='?' (Size = 4000), @p7='?' (DbType = DateTime2), @p8='?' (Size = 4000), @p9='?' (DbType = DateTime2), @p10='?' (DbType = Int64), @p11='?' (DbType = Single), @p12='?' (Size = 4000), @p13='?' (DbType = DateTime2), @p14='?' (Size = 4000), @p15='?' (DbType = DateTime2), @p16='?' (DbType = Int64), @p17='?' (DbType = Single), @p18='?' (Size = 4000), @p19='?' (DbType = DateTime2), @p20='?' (Size = 4000), @p21='?' (DbType = DateTime2), @p22='?' (DbType = Int64), @p23='?' (DbType = Single), @p24='?' (Size = 4000), @p25='?' (DbType = DateTime2), @p26='?' (Size = 4000), @p27='?' (DbType = DateTime2), @p28='?' (DbType = Int64), @p29='?' (DbType = Single), @p56='?' (DbType = Int64), @p30='?' (DbType = Single), @p31='?' (DbType = Single), @p32='?' (DbType = Single), @p33='?' (Size = 4000), @p34='?' (Size = 4000), @p35='?' (DbType = DateTime2), @p36='?' (DbType = Single), @p37='?' (DbType = Single), @p38='?' (DbType = Single), @p39='?' (DbType = Single), @p40='?' (DbType = Single), @p41='?' (DbType = Single), @p42='?' (DbType = Single), @p43='?' (Size = 4000), @p44='?' (DbType = Int64), @p45='?' (DbType = Int64), @p46='?' (Size = 4000), @p47='?' (DbType = DateTime2), @p48='?' (DbType = Single), @p49='?' (DbType = Single), @p50='?' (DbType = Single), @p51='?' (DbType = Single), @p52='?' (Size = 4000), @p53='?' (DbType = Single), @p54='?' (Size = 4000), @p55='?' (DbType = Single), @p66='?' (DbType = Int64), @p57='?' (Size = 4000), @p58='?' (Size = 4000), @p59='?' (DbType = DateTime2), @p60='?' (Size = 4000), @p61='?' (DbType = DateTime2), @p62='?' (Size = 4000), @p63='?' (DbType = Single), @p64='?' (DbType = Single), @p65='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [RPAB_LoiIchCuaCoDongKhongKiemSoatTruoc2015] ([CreatedBy], [CreatedOn], [LastModifiedBy], [LastModifiedOn], [StockReportAccountingBalanceId], [TongCong])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [Id]
FROM [RPAB_LoiIchCuaCoDongKhongKiemSoatTruoc2015]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();

INSERT INTO [RPAB_NoPhaiTra] ([CreatedBy], [CreatedOn], [LastModifiedBy], [LastModifiedOn], [StockReportAccountingBalanceId], [TongCong])
VALUES (@p6, @p7, @p8, @p9, @p10, @p11);
SELECT [Id]
FROM [RPAB_NoPhaiTra]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();

INSERT INTO [RPAB_TaiSanDaiHan] ([CreatedBy], [CreatedOn], [LastModifiedBy], [LastModifiedOn], [StockReportAccountingBalanceId], [TongCong])
VALUES (@p12, @p13, @p14, @p15, @p16, @p17);
SELECT [Id]
FROM [RPAB_TaiSanDaiHan]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();

INSERT INTO [RPAB_TaiSanNganHan] ([CreatedBy], [CreatedOn], [LastModifiedBy], [LastModifiedOn], [StockReportAccountingBalanceId], [TongCong])
VALUES (@p18, @p19, @p20, @p21, @p22, @p23);
SELECT [Id]
FROM [RPAB_TaiSanNganHan]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();

INSERT INTO [RPAB_VonChuSoHuu] ([CreatedBy], [CreatedOn], [LastModifiedBy], [LastModifiedOn], [StockReportAccountingBalanceId], [TongCong])
VALUES (@p24, @p25, @p26, @p27, @p28, @p29);
SELECT [Id]
FROM [RPAB_VonChuSoHuu]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();

UPDATE [StockIndex] SET [BVPS] = @p30, [Beta] = @p31, [CaoNhat52Tuan] = @p32, [Code] = @p33, [CreatedBy] = @p34, [CreatedOn] = @p35, [EPS] = @p36, [FreeFloat] = @p37, [GiaCaoNhat] = @p38, [GiaMoCua] = @p39, [GiaSan] = @p40, [GiaThapNhat] = @p41, [GiaTran] = @p42, [InforDate] = @p43, [KLGDTrongPhien] = @p44, [KLGDTrungBinh10Phien] = @p45, [LastModifiedBy] = @p46, [LastModifiedOn] = @p47, [PB] = @p48, [PE] = @p49, [ROAA] = @p50, [ROAE] = @p51, [SoCPLuuHanh] = @p52, [ThapNhat52Tuan] = @p53, [TySuatCoTuc] = @p54, [VonHoaThiTruong] = @p55
WHERE [Id] = @p56;
SELECT @@ROWCOUNT;

UPDATE [StockReportAccountingBalance] SET [Code] = @p57, [CreatedBy] = @p58, [CreatedOn] = @p59, [LastModifiedBy] = @p60, [LastModifiedOn] = @p61, [Quarter] = @p62, [TongCongNguonVon] = @p63, [TongCongTaiSan] = @p64, [Year] = @p65
WHERE [Id] = @p66;
SELECT @@ROWCOUNT;"
2021-01-26T16:43:57.3622047+07:00 [ERR] (Microsoft.EntityFrameworkCore.Update) An exception occurred in the database while saving changes for context type '"Infrastructure.Data.ApplicationDbContext"'."
""Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert duplicate key row in object 'dbo.RPAB_LoiIchCuaCoDongKhongKiemSoatTruoc2015' with unique index 'IX_RPAB_LoiIchCuaCoDongKhongKiemSoatTruoc2015_StockReportAccountingBalanceId'. The duplicate key value is (1).
Cannot insert duplicate key row in object 'dbo.RPAB_NoPhaiTra' with unique index 'IX_RPAB_NoPhaiTra_StockReportAccountingBalanceId'. The duplicate key value is (1).
Cannot insert duplicate key row in object 'dbo.RPAB_TaiSanDaiHan' with unique index 'IX_RPAB_TaiSanDaiHan_StockReportAccountingBalanceId'. The duplicate key value is (1).
Cannot insert duplicate key row in object 'dbo.RPAB_TaiSanNganHan' with unique index 'IX_RPAB_TaiSanNganHan_StockReportAccountingBalanceId'. The duplicate key value is (1).
Cannot insert duplicate key row in object 'dbo.RPAB_VonChuSoHuu' with unique index 'IX_RPAB_VonChuSoHuu_StockReportAccountingBalanceId'. The duplicate key value is (1).
The statement has been terminated.
The statement has been terminated.
The statement has been terminated.
The statement has been terminated.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__164_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:da8a2a12-285d-4ff3-91f5-0c779a243e3a
Error Number:2601,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)"
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert duplicate key row in object 'dbo.RPAB_LoiIchCuaCoDongKhongKiemSoatTruoc2015' with unique index 'IX_RPAB_LoiIchCuaCoDongKhongKiemSoatTruoc2015_StockReportAccountingBalanceId'. The duplicate key value is (1).
Cannot insert duplicate key row in object 'dbo.RPAB_NoPhaiTra' with unique index 'IX_RPAB_NoPhaiTra_StockReportAccountingBalanceId'. The duplicate key value is (1).
Cannot insert duplicate key row in object 'dbo.RPAB_TaiSanDaiHan' with unique index 'IX_RPAB_TaiSanDaiHan_StockReportAccountingBalanceId'. The duplicate key value is (1).
Cannot insert duplicate key row in object 'dbo.RPAB_TaiSanNganHan' with unique index 'IX_RPAB_TaiSanNganHan_StockReportAccountingBalanceId'. The duplicate key value is (1).
Cannot insert duplicate key row in object 'dbo.RPAB_VonChuSoHuu' with unique index 'IX_RPAB_VonChuSoHuu_StockReportAccountingBalanceId'. The duplicate key value is (1).
The statement has been terminated.
The statement has been terminated.
The statement has been terminated.
The statement has been terminated.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__164_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:da8a2a12-285d-4ff3-91f5-0c779a243e3a
Error Number:2601,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-01-26T16:44:10.4965533+07:00 [ERR] (ASPNetCore3.ServiceImpl.StockCrawlerService) fail on update for stock IDV ======= 24,600;66.00;54.00;60.00;60.00;58.60;1,020 tỷ;44,278;61.00;27.70;17 trCP;14%;0.6;5.2x;2.4x;53.7%;16.5%;5.7%;11,546;24,819
